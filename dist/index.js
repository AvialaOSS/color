(function(d,w){typeof exports=="object"&&typeof module<"u"?w(exports,require("color")):typeof define=="function"&&define.amd?define(["exports","color"],w):(d=typeof globalThis<"u"?globalThis:d||self,w(d.AvialaColor={},d.Color))})(this,function(d,w){"use strict";function O(t){return w(t).rgb().round().color.join(",")}const G=["hex","rgb","hsl"];function j(t){return!t||!G.includes(t)?"hex":t}function F(t,n){const i=j(n);return i==="hex"?t[i]().toLowerCase():t[i]().round().string()}function D(t,n,i){const r=w(t),o=r.hue(),a=r.saturationv(),e=r.value(),s=(y=>y>=60&&y<=240?2.5:y>=0&&y<60||y>300&&y<=360?1.5:2)(o),l=100,f=9,u=100,h=30;function m(y,p){let x;return o>=60&&o<=240?x=y?o-s*p:o+s*p:x=y?o+s*p:o-s*p,x<0?x+=360:x>=360&&(x-=360),Math.round(x)}function M(y,p){let x;if(y)x=a<=f?a:a-(a-f)/5.5*Math.pow(p,1.05);else{const q=Math.min(l,a+30);x=a+(q-a)/4.2*Math.pow(p,.95)}return Math.max(0,Math.min(100,x))}function b(y,p){return y?Math.min(u,e+(u-e)/5.2*Math.pow(p,.9)):e<=h?e:Math.max(h,e-(e-h)/4.2*Math.pow(p,1.05))}const g=n<6,E=g?6-n:n-6,S=n===6?r:w({h:m(g,E),s:M(g,E),v:b(g,E)});return F(S,i)}function A(t,n,i){const r=w(D(t,10-n+1,"hex")),o=w(t),a=o.hue(),e=o.saturationv();function c(m){if(m<6)return l+(6-m)*u;if(m===6){if(a>=0&&a<50)return e-15;if(a>=50&&a<191)return e-20;if(a>=191&&a<=360)return e-15}return l-f*(m-6)}const l=w({h:o.hue(),s:c(6),v:o.value()}).saturationv(),f=Math.ceil((l-9)/4),u=Math.ceil((100-l)/5),h=w({h:r.hue(),s:c(n),v:r.value()});return F(h,i)}function T(t,n={}){const{dark:i,list:r,index:o=6,format:a="hex"}=n;if(r){const e=[],c=i?A:D;for(let s=1;s<=10;s++)e.push(c(t,s,a));return e}return i?A(t,o,a):D(t,o,a)}async function P(t){try{const n=await V(t),i=N(n);return U(i)}catch(n){throw console.error("提取图片颜色失败:",n),n}}async function V(t){return new Promise((n,i)=>{try{if(typeof document>"u"){i(new Error("图像颜色提取功能仅在浏览器环境中可用"));return}const r=document.createElement("canvas"),o=r.getContext("2d");if(!o){i(new Error("无法获取canvas 2d context"));return}const a=Math.min(t.width,100),e=Math.min(t.height,100),c=Math.min(a/t.width,e/t.height);r.width=t.width*c,r.height=t.height*c,o.drawImage(t,0,0,r.width,r.height);const s=o.getImageData(0,0,r.width,r.height);n(s)}catch(r){i(r)}})}function N(t){const n=t.data,i=new Map;for(let o=0;o<n.length;o+=4){const a=n[o],e=n[o+1],c=n[o+2];if(n[o+3]<128)continue;const l=Math.round(a/16)*16,f=Math.round(e/16)*16,u=Math.round(c/16)*16,h=`${l},${f},${u}`;i.has(h)?i.set(h,i.get(h)+1):i.set(h,1)}const r=[];return i.forEach((o,a)=>{const[e,c,s]=a.split(",").map(Number);r.push({r:e,g:c,b:s,count:o})}),r}function U(t){t.sort((o,a)=>a.count-o.count);const n=t.filter(o=>{const{r:a,g:e,b:c}=o,s=Math.max(a,e,c),l=Math.min(a,e,c),f=s-l,u=s===0?0:f/s,h=s/255;return u>.15&&h>.2&&h<.8}),i=n.length>0?n[0]:t[0];return w({r:i.r,g:i.g,b:i.b}).hex()}function K(t){return new Promise((n,i)=>{if(typeof FileReader>"u"||typeof Image>"u"){i(new Error("文件读取功能仅在浏览器环境中可用"));return}if(!t.type.startsWith("image/")){i(new Error("请选择图片文件"));return}const r=new FileReader;r.onload=async o=>{var a;try{const e=new Image;e.onload=async()=>{try{const s=await P(e);n(s)}catch(s){i(s)}},e.onerror=()=>i(new Error("图片加载失败"));const c=(a=o.target)==null?void 0:a.result;typeof c=="string"?e.src=c:i(new Error("无法读取图片数据"))}catch(e){i(e)}},r.onerror=()=>i(new Error("文件读取失败")),r.readAsDataURL(t)})}function C(t,n,i={}){const{steps:r=10,format:o="hex",includeEnds:a=!0}=i;if(r<2)throw new Error("步数必须至少为2");const e=w(t),c=w(n),s=[],l=a?r:r+2,f=1/(l-1);for(let u=0;u<l;u++){const h=u*f,m=Math.round(e.red()+(c.red()-e.red())*h),M=Math.round(e.green()+(c.green()-e.green())*h),b=Math.round(e.blue()+(c.blue()-e.blue())*h),g=w({r:m,g:M,b});!a&&(u===0||u===l-1)||s.push(F(g,o))}return s}function W(t={}){const{startGray:n="#ffffff",endGray:i="#000000",steps:r=10,format:o="hex"}=t;return C(n,i,{steps:r,format:o,includeEnds:!0})}function z(t,n={}){const{steps:i=10,format:r="hex",lightnessRange:o=80,minLightness:a=null,maxLightness:e=null}=n,c=w(t);let s,l;if(a!==null&&e!==null)s=Math.max(0,Math.min(100,e)),l=Math.max(0,Math.min(100,a));else{const h=c.lightness();s=Math.min(95,h+o/2),l=Math.max(5,h-o/2)}const f=w({h:c.hue(),s:c.saturationl(),l:s}),u=w({h:c.hue(),s:c.saturationl(),l});return C(f.hex(),u.hex(),{steps:i,format:r,includeEnds:!0})}function J(t,n,i={}){const{steps:r=10,format:o="hex",includeEnds:a=!0}=i;if(r<2)throw new Error("步数必须至少为2");const e=w(t),c=w(n),s=[],l=a?r:r+2,f=1/(l-1);let u=e.hue()||0,h=c.hue()||0;const m=h-u;Math.abs(m)>180&&(m>0?u+=360:h+=360);const M=e.saturationl(),b=c.saturationl(),g=e.lightness(),E=c.lightness();for(let S=0;S<l;S++){const y=S*f;let p=u+(h-u)*y;const x=M+(b-M)*y,q=g+(E-g)*y;p=p%360,p<0&&(p+=360);const tt=w({h:p,s:x,l:q});!a&&(S===0||S===l-1)||s.push(F(tt,o))}return s}function R(t){if(!t||typeof t!="string")throw new Error("Invalid RGB color: must be a string");let n=t.replace("#","");if(n.length===8&&(n=n.substring(0,6)),!/^[0-9A-Fa-f]{6}$/.test(n))throw new Error("Invalid RGB color format: must be #rrggbb or rrggbb");const i=parseInt(n.slice(0,2),16)/255,r=parseInt(n.slice(2,4),16)/255,o=parseInt(n.slice(4,6),16)/255,a=Math.max(i,r,o),e=Math.min(i,r,o),c=a-e;let s=0;c!==0&&(a===i?s=(r-o)/c%6:a===r?s=(o-i)/c+2:s=(i-r)/c+4),s=Math.round(s*60),s<0&&(s+=360);const l=Math.round((.299*i+.587*r+.114*o)*100),f=(a+e)/2;let u=0;c!==0&&f!==0&&f!==1&&(u=c/(1-Math.abs(2*f-1)));let h=0;return l>0&&l<100&&(h=Math.round(u*Math.min(l,100-l))),{h:s,c:Math.max(0,h),t:Math.max(0,Math.min(100,l))}}function L(t,n={}){if(!t||typeof t!="object"||t.h===void 0||t.c===void 0||t.t===void 0)throw new Error("Invalid HCT color: must be an object with h, c, t properties");const{h:i,c:r,t:o}=t,{maxChroma:a=200}=n,e=(i%360+360)%360,c=Math.max(0,Math.min(a,r)),s=Math.max(0,Math.min(100,o)),l=s/100;let f=0;if(s>0&&s<100&&c>0){const S=Math.min(s,100-s);f=S>0?c/S:0}const u=(1-Math.abs(2*l-1))*Math.min(1,f),h=u*(1-Math.abs(e/60%2-1)),m=l-u/2;let M,b,g;e>=0&&e<60?[M,b,g]=[u,h,0]:e>=60&&e<120?[M,b,g]=[h,u,0]:e>=120&&e<180?[M,b,g]=[0,u,h]:e>=180&&e<240?[M,b,g]=[0,h,u]:e>=240&&e<300?[M,b,g]=[h,0,u]:[M,b,g]=[u,0,h];const E=S=>{const y=Math.max(0,Math.min(1,S+m)),p=Math.round(y*255).toString(16);return p.length===1?"0"+p:p};return`#${E(M)}${E(b)}${E(g)}`}function H(t,n,i=.5){if(!t||!n)throw new Error("Both colors are required for blending");const r=Math.max(0,Math.min(1,i)),o=R(t),a=R(n);let e=o.h,c=a.h,s=c-e;Math.abs(s)>180&&(s>0?e+=360:c+=360,s=c-e);const l=(e+s*r)%360,f=o.c+(a.c-o.c)*r,u=o.t+(a.t-o.t)*r;return L({h:l<0?l+360:l,c:Math.max(0,Math.round(f)),t:Math.max(0,Math.min(100,Math.round(u)))})}function Q(t,n,i=.15){if(!t||!n)throw new Error("Both theme color and target color are required");const r=Math.max(0,Math.min(1,i)),o=R(t),a=R(n);let e=a.h,c=o.h,s=c-e;Math.abs(s)>180&&(s>0?e+=360:c+=360,s=c-e);const l=(e+s*r)%360;return L({h:l<0?l+360:l,c:a.c,t:a.t})}function X(t,n){if(!t)throw new Error("Theme color is required");const i=R(t);let r;if(Array.isArray(n)?r=n:n&&n.tones&&Array.isArray(n.tones)?r=n.tones:r=[10,20,30,40,50,60,70,80,90],!Array.isArray(r)||r.length===0)throw new Error("Tone steps must be a non-empty array");const o=r.filter(a=>typeof a=="number"&&a>=0&&a<=100);if(o.length===0)throw new Error("No valid tone values found (must be numbers between 0-100)");return o.map(a=>L({h:i.h,c:i.c,t:a}))}function k(t,n,i=.2){if(!t)throw new Error("Theme color is required");if(!n||typeof n!="object")throw new Error("UI colors must be an object");const r=Math.max(0,Math.min(1,i)),o={};for(const[a,e]of Object.entries(n))try{o[a]=H(t,e,r)}catch(c){console.warn(`Failed to blend color for key "${a}": ${c.message}`),o[a]=e}return o}function I(t,n={}){if(!t)throw new Error("Theme color is required");const{baseGray:i="#989898ff",blendRatio:r=.08,isDark:o=!1,steps:a=12,lightnessRange:e=85,minLightness:c=null,maxLightness:s=null}=n,l=Math.max(0,Math.min(1,r)),f=Math.max(2,Math.min(100,Math.round(a))),u=H(i,t,l),h={steps:f,format:"hex"};if(c!==null&&s!==null)h.minLightness=c,h.maxLightness=s;else{const g=Math.max(20,Math.min(95,e));h.lightnessRange=g}const m=z(u,h),M=o?m.reverse():m,b={};return M.forEach((g,E)=>{b[`gray-${E+1}`]=g}),b}function B(t,n={}){if(!t)throw new Error("Theme color is required");const{semanticColors:i={success:"#52c41a",warning:"#faad14",error:"#ff4d4f",info:"#1890ff"},blendRatio:r=0,isDark:o=!1}=n;if(!i||typeof i!="object")throw new Error("Semantic colors must be an object");const a=Math.max(0,Math.min(1,r)),e={};return Object.entries(i).forEach(([c,s])=>{if(!s||typeof s!="string"){console.warn(`Invalid color for semantic color "${c}": ${s}`);return}try{const l={},f=R(s);(o?[90,80,70,60,50,40,30,25,20,15]:[15,25,35,45,55,65,75,85,90,95]).forEach((h,m)=>{const M={h:f.h,c:f.c,t:h},b=H(L(M),t,a);l[`${c}-${m+1}`]=b}),Object.assign(e,l)}catch(l){console.warn(`Failed to generate variants for semantic color "${c}": ${l.message}`)}}),e}function $(t,n={}){if(!t)throw new Error("Theme color is required");const{isDark:i=!1}=n,r=R(t),o={};return(i?[90,80,70,60,50,40,30,25,20,15]:[15,25,35,45,55,65,75,85,90,95]).forEach((e,c)=>{const s={h:r.h,c:r.c,t:e};o[`theme-${c+1}`]=L(s)}),o}function Y(t,n={}){if(!t)throw new Error("Theme color is required");const{baseGray:i="#666666",isDark:r=!1,semanticColors:o,controlBlendRatio:a=.08,semanticBlendRatio:e=.12,controlSteps:c=12,controlLightnessRange:s=85,controlMinLightness:l=null,controlMaxLightness:f=null}=n,u=Math.max(0,Math.min(1,a)),h=Math.max(0,Math.min(1,e)),m={baseGray:i,blendRatio:u,isDark:r,steps:c};return l!==null&&f!==null?(m.minLightness=l,m.maxLightness=f):m.lightnessRange=s,{controls:I(t,m),semantic:B(t,{semanticColors:o,blendRatio:h,isDark:r}),theme:$(t,{isDark:r})}}function Z(t,n={}){if(!t)throw new Error("Theme color is required");const{semanticColors:i={success:"#52c41a",warning:"#faad14",error:"#ff4d4f",info:"#1890ff"},uiColors:r={background:"#ffffff",surface:"#fafafa",border:"#d9d9d9",disabled:"#f5f5f5"},harmonizeRatio:o=.15,blendRatio:a=.12,isDark:e=!1}=n,c=Math.max(0,Math.min(1,o)),s=Math.max(0,Math.min(1,a)),l=$(t,{isDark:e}),f=I(t,{blendRatio:s*.5,isDark:e}),u=B(t,{semanticColors:i,blendRatio:c,isDark:e}),h={};return Object.entries(i).forEach(([M])=>{h[M]={};for(let b=1;b<=10;b++){const g=`${M}-${b}`;u[g]&&(h[M][b]=u[g])}}),{theme:l,controls:f,semantic:h,ui:k(t,r,s)}}const v={red:"#F53F3F",orangered:"#F77234",orange:"#FF7D00",gold:"#F7BA1E",yellow:"#FADC19",lime:"#9FDB1D",green:"#00B42A",cyan:"#14C9C9",blue:"#3491FA",arcoblue:"#165DFF",purple:"#722ED1",pinkpurple:"#D91AD9",magenta:"#F5319D"};function _(){const t={};return Object.keys(v).forEach(n=>{t[n]={},t[n].light=T(v[n],{list:!0}),t[n].dark=T(v[n],{list:!0,dark:!0}),t[n].primary=v[n]}),t.gray={},t.gray.light=["#f7f8fa","#f2f3f5","#e5e6eb","#c9cdd4","#a9aeb8","#86909c","#6b7785","#4e5969","#272e3b","#1d2129"],t.gray.dark=["#17171a","#2e2e30","#484849","#5f5f60","#78787a","#929293","#ababac","#c5c5c5","#dfdfdf","#f6f6f6"],t.gray.primary=t.gray.light[6],t}d.blendInHct=H,d.blendUIColors=k,d.colorList=v,d.extractColorFromFile=K,d.extractColorFromImage=P,d.generate=T,d.generateControlColors=I,d.generateGrayLinear=W,d.generateInterfaceColorSystem=Y,d.generateLinear=C,d.generateLinearHSL=J,d.generateMonochromeLinear=z,d.generateSemanticColors=B,d.generateThemeColors=$,d.generateThemePalette=Z,d.generateThemeVariants=X,d.getPresetColors=_,d.getRgbStr=O,d.harmonizeColor=Q,d.hctToRgb=L,d.rgbToHct=R,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
