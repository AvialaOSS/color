(function(d,M){typeof exports=="object"&&typeof module<"u"?M(exports,require("color")):typeof define=="function"&&define.amd?define(["exports","color"],M):(d=typeof globalThis<"u"?globalThis:d||self,M(d.AvialaColor={},d.Color))})(this,function(d,M){"use strict";function z(t){return M(t).rgb().round().color.join(",")}const k=["hex","rgb","hsl"];function G(t){return!t||k.indexOf(t)<0?"hex":t}function D(t,n){const s=G(n);return s==="hex"?t[s]().toLowerCase():t[s]().round().string()}function v(t,n,s){const o=M(t),a=o.hue(),r=o.saturationv(),e=o.value(),c=(w=>w>=60&&w<=240?2.5:w>=0&&w<60||w>300&&w<=360?1.5:2)(a),l=100,u=9,h=100,f=30;function p(w,y){let S;return a>=60&&a<=240?S=w?a-c*y:a+c*y:S=w?a+c*y:a-c*y,S<0?S+=360:S>=360&&(S-=360),Math.round(S)}function m(w,y){let S;if(w)S=r<=u?r:r-(r-u)/5.5*Math.pow(y,1.05);else{const _=Math.min(l,r+30);S=r+(_-r)/4.2*Math.pow(y,.95)}return Math.max(0,Math.min(100,S))}function b(w,y){return w?Math.min(h,e+(h-e)/5.2*Math.pow(y,.9)):e<=f?e:Math.max(f,e-(e-f)/4.2*Math.pow(y,1.05))}const g=n<6,x=g?6-n:n-6,R=n===6?o:M({h:p(g,x),s:m(g,x),v:b(g,x)});return D(R,s)}function q(t,n,s){const o=M(v(t,10-n+1)),a=M(t),r=a.hue(),e=a.saturationv(),c=M({h:a.hue(),s:h(6),v:a.value()}).saturationv(),l=Math.ceil((c-9)/4),u=Math.ceil((100-c)/5);function h(p){if(p<6)return c+(6-p)*u;if(p===6){if(r>=0&&r<50)return e-15;if(r>=50&&r<191)return e-20;if(r>=191&&r<=360)return e-15}return c-l*(p-6)}const f=M({h:o.hue(),s:h(n),v:o.value()});return D(f,s)}function C(t,n={}){const{dark:s,list:o,index:a=6,format:r="hex"}=n;if(o){const e=[],i=s?q:v;for(let c=1;c<=10;c++)e.push(i(t,c,r));return e}return s?q(t,a,r):v(t,a,r)}async function A(t){try{const n=await j(t),s=V(n);return O(s)}catch(n){throw console.error("提取图片颜色失败:",n),n}}async function j(t){return new Promise((n,s)=>{try{if(typeof document>"u"){s(new Error("图像颜色提取功能仅在浏览器环境中可用"));return}const o=document.createElement("canvas"),a=o.getContext("2d"),r=Math.min(t.width,100),e=Math.min(t.height,100),i=Math.min(r/t.width,e/t.height);o.width=t.width*i,o.height=t.height*i,a.drawImage(t,0,0,o.width,o.height);const c=a.getImageData(0,0,o.width,o.height);n(c)}catch(o){s(o)}})}function V(t){const n=t.data,s=new Map;for(let a=0;a<n.length;a+=4){const r=n[a],e=n[a+1],i=n[a+2];if(n[a+3]<128)continue;const l=Math.round(r/16)*16,u=Math.round(e/16)*16,h=Math.round(i/16)*16,f=`${l},${u},${h}`;s.has(f)?s.set(f,s.get(f)+1):s.set(f,1)}const o=[];return s.forEach((a,r)=>{const[e,i,c]=r.split(",").map(Number);o.push({r:e,g:i,b:c,count:a})}),o}function O(t){t.sort((a,r)=>r.count-a.count);const n=t.filter(a=>{const{r,g:e,b:i}=a,c=Math.max(r,e,i),l=Math.min(r,e,i),u=c-l,h=c===0?0:u/c,f=c/255;return h>.15&&f>.2&&f<.8}),s=n.length>0?n[0]:t[0];return M({r:s.r,g:s.g,b:s.b}).hex()}function N(t){return new Promise((n,s)=>{if(typeof FileReader>"u"||typeof Image>"u"){s(new Error("文件读取功能仅在浏览器环境中可用"));return}if(!t.type.startsWith("image/")){s(new Error("请选择图片文件"));return}const o=new FileReader;o.onload=async a=>{try{const r=new Image;r.onload=async()=>{try{const e=await A(r);n(e)}catch(e){s(e)}},r.onerror=()=>s(new Error("图片加载失败")),r.src=a.target.result}catch(r){s(r)}},o.onerror=()=>s(new Error("文件读取失败")),o.readAsDataURL(t)})}function I(t,n,s={}){const{steps:o=10,format:a="hex",includeEnds:r=!0}=s;if(o<2)throw new Error("步数必须至少为2");const e=M(t),i=M(n),c=[],l=r?o:o+2,u=1/(l-1);for(let h=0;h<l;h++){const f=h*u,p=Math.round(e.red()+(i.red()-e.red())*f),m=Math.round(e.green()+(i.green()-e.green())*f),b=Math.round(e.blue()+(i.blue()-e.blue())*f),g=M({r:p,g:m,b});!r&&(h===0||h===l-1)||c.push(D(g,a))}return c}function U(t={}){const{startGray:n="#ffffff",endGray:s="#000000",steps:o=10,format:a="hex"}=t;return I(n,s,{steps:o,format:a,includeEnds:!0})}function K(t,n={}){const{steps:s=10,format:o="hex",lightnessRange:a=80}=n,r=M(t),e=r.hsl(),i=r.lightness(),c=Math.min(95,i+a/2),l=Math.max(5,i-a/2),u=M({h:e.color[0],s:e.color[1],l:c}),h=M({h:e.color[0],s:e.color[1],l});return I(u.hex(),h.hex(),{steps:s,format:o,includeEnds:!0})}function W(t,n,s={}){const{steps:o=10,format:a="hex",includeEnds:r=!0}=s;if(o<2)throw new Error("步数必须至少为2");const e=M(t).hsl(),i=M(n).hsl(),c=[],l=r?o:o+2,u=1/(l-1);let h=e.color[0]||0,f=i.color[0]||0;const p=f-h;Math.abs(p)>180&&(p>0?h+=360:f+=360);for(let m=0;m<l;m++){const b=m*u;let g=h+(f-h)*b;const x=e.color[1]+(i.color[1]-e.color[1])*b,R=e.color[2]+(i.color[2]-e.color[2])*b;g=g%360,g<0&&(g+=360);const w=M({h:g,s:x,l:R});!r&&(m===0||m===l-1)||c.push(D(w,a))}return c}function E(t){if(!t||typeof t!="string")throw new Error("Invalid RGB color: must be a string");const n=t.replace("#","");if(!/^[0-9A-Fa-f]{6}$/.test(n))throw new Error("Invalid RGB color format: must be #rrggbb or rrggbb");const s=parseInt(n.slice(0,2),16)/255,o=parseInt(n.slice(2,4),16)/255,a=parseInt(n.slice(4,6),16)/255,r=Math.max(s,o,a),e=Math.min(s,o,a),i=r-e;let c=0;i!==0&&(r===s?c=(o-a)/i%6:r===o?c=(a-s)/i+2:c=(s-o)/i+4),c=Math.round(c*60),c<0&&(c+=360);const l=Math.round((.299*s+.587*o+.114*a)*100),u=(r+e)/2;let h=0;i!==0&&u!==0&&u!==1&&(h=i/(1-Math.abs(2*u-1)));let f=0;return l>0&&l<100&&(f=Math.round(h*Math.min(l,100-l))),{h:c,c:Math.max(0,f),t:Math.max(0,Math.min(100,l))}}function H(t,n={}){if(!t||typeof t!="object"||t.h===void 0||t.c===void 0||t.t===void 0)throw new Error("Invalid HCT color: must be an object with h, c, t properties");const{h:s,c:o,t:a}=t,{maxChroma:r=200}=n,e=(s%360+360)%360,i=Math.max(0,Math.min(r,o)),c=Math.max(0,Math.min(100,a)),l=c/100;let u=0;if(c>0&&c<100&&i>0){const R=Math.min(c,100-c);u=R>0?i/R:0}const h=(1-Math.abs(2*l-1))*Math.min(1,u),f=h*(1-Math.abs(e/60%2-1)),p=l-h/2;let m,b,g;e>=0&&e<60?[m,b,g]=[h,f,0]:e>=60&&e<120?[m,b,g]=[f,h,0]:e>=120&&e<180?[m,b,g]=[0,h,f]:e>=180&&e<240?[m,b,g]=[0,f,h]:e>=240&&e<300?[m,b,g]=[f,0,h]:[m,b,g]=[h,0,f];const x=R=>{const w=Math.max(0,Math.min(1,R+p)),y=Math.round(w*255).toString(16);return y.length===1?"0"+y:y};return`#${x(m)}${x(b)}${x(g)}`}function T(t,n,s=.5){if(!t||!n)throw new Error("Both colors are required for blending");const o=Math.max(0,Math.min(1,s)),a=E(t),r=E(n);let e=a.h,i=r.h,c=i-e;Math.abs(c)>180&&(c>0?e+=360:i+=360,c=i-e);const l=(e+c*o)%360,u=a.c+(r.c-a.c)*o,h=a.t+(r.t-a.t)*o;return H({h:l<0?l+360:l,c:Math.max(0,Math.round(u)),t:Math.max(0,Math.min(100,Math.round(h)))})}function J(t,n,s=.15){if(!t||!n)throw new Error("Both theme color and target color are required");const o=Math.max(0,Math.min(1,s)),a=E(t),r=E(n);let e=r.h,i=a.h,c=i-e;Math.abs(c)>180&&(c>0?e+=360:i+=360,c=i-e);const l=(e+c*o)%360;return H({h:l<0?l+360:l,c:r.c,t:r.t})}function Q(t,n=[10,20,30,40,50,60,70,80,90]){if(!t)throw new Error("Theme color is required");const s=E(t);let o;if(Array.isArray(n)?o=n:n&&n.tones&&Array.isArray(n.tones)?o=n.tones:o=[10,20,30,40,50,60,70,80,90],!Array.isArray(o)||o.length===0)throw new Error("Tone steps must be a non-empty array");const a=o.filter(r=>typeof r=="number"&&r>=0&&r<=100);if(a.length===0)throw new Error("No valid tone values found (must be numbers between 0-100)");return a.map(r=>H({h:s.h,c:s.c,t:r}))}function P(t,n,s=.2){if(!t)throw new Error("Theme color is required");if(!n||typeof n!="object")throw new Error("UI colors must be an object");const o=Math.max(0,Math.min(1,s)),a={};for(const[r,e]of Object.entries(n))try{a[r]=T(t,e,o)}catch(i){console.warn(`Failed to blend color for key "${r}": ${i.message}`),a[r]=e}return a}function $(t,n={}){if(!t)throw new Error("Theme color is required");const{baseGray:s="#666666",blendRatio:o=.08,isDark:a=!1}=n,r=Math.max(0,Math.min(1,o)),e=E(s),i={};return(a?[95,90,85,80,70,60,50,40,30,20,15,10]:[10,15,20,30,40,50,60,70,80,85,90,95]).forEach((l,u)=>{const h={h:e.h,c:e.c,t:l},f=T(H(h),t,r);i[`gray-${u+1}`]=f}),i}function B(t,n={}){if(!t)throw new Error("Theme color is required");const{semanticColors:s={success:"#52c41a",warning:"#faad14",error:"#ff4d4f",info:"#1890ff"},blendRatio:o=0,isDark:a=!1}=n;if(!s||typeof s!="object")throw new Error("Semantic colors must be an object");const r=Math.max(0,Math.min(1,o)),e={};return Object.entries(s).forEach(([i,c])=>{if(!c||typeof c!="string"){console.warn(`Invalid color for semantic color "${i}": ${c}`);return}try{const l={},u=E(c);(a?[90,80,70,60,50,40,30,25,20,15]:[15,25,35,45,55,65,75,85,90,95]).forEach((f,p)=>{const m={h:u.h,c:u.c,t:f},b=T(H(m),t,r);l[`${i}-${p+1}`]=b}),Object.assign(e,l)}catch(l){console.warn(`Failed to generate variants for semantic color "${i}": ${l.message}`)}}),e}function L(t,n={}){if(!t)throw new Error("Theme color is required");const{isDark:s=!1}=n,o=E(t),a={};return(s?[90,80,70,60,50,40,30,25,20,15]:[15,25,35,45,55,65,75,85,90,95]).forEach((e,i)=>{const c={h:o.h,c:o.c,t:e};a[`theme-${i+1}`]=H(c)}),a}function X(t,n={}){if(!t)throw new Error("Theme color is required");const{baseGray:s="#666666",isDark:o=!1,semanticColors:a,controlBlendRatio:r=.08,semanticBlendRatio:e=.12}=n,i=Math.max(0,Math.min(1,r)),c=Math.max(0,Math.min(1,e));return{controls:$(t,{baseGray:s,blendRatio:i,isDark:o}),semantic:B(t,{semanticColors:a,blendRatio:c,isDark:o}),theme:L(t,{isDark:o})}}function Y(t,n={}){if(!t)throw new Error("Theme color is required");const{semanticColors:s={success:"#52c41a",warning:"#faad14",error:"#ff4d4f",info:"#1890ff"},uiColors:o={background:"#ffffff",surface:"#fafafa",border:"#d9d9d9",disabled:"#f5f5f5"},harmonizeRatio:a=.15,blendRatio:r=.12,isDark:e=!1}=n,i=Math.max(0,Math.min(1,a)),c=Math.max(0,Math.min(1,r)),l=L(t,{isDark:e}),u=$(t,{blendRatio:c*.5,isDark:e}),h=B(t,{semanticColors:s,blendRatio:i,isDark:e}),f={};return Object.entries(s).forEach(([m])=>{f[m]={};for(let b=1;b<=10;b++){const g=`${m}-${b}`;h[g]&&(f[m][b]=h[g])}}),{theme:l,controls:u,semantic:f,ui:P(t,o,c)}}const F={red:"#F53F3F",orangered:"#F77234",orange:"#FF7D00",gold:"#F7BA1E",yellow:"#FADC19",lime:"#9FDB1D",green:"#00B42A",cyan:"#14C9C9",blue:"#3491FA",arcoblue:"#165DFF",purple:"#722ED1",pinkpurple:"#D91AD9",magenta:"#F5319D"};function Z(){const t={};return Object.keys(F).forEach(n=>{t[n]={},t[n].light=C(F[n],{list:!0}),t[n].dark=C(F[n],{list:!0,dark:!0}),t[n].primary=F[n]}),t.gray={},t.gray.light=["#f7f8fa","#f2f3f5","#e5e6eb","#c9cdd4","#a9aeb8","#86909c","#6b7785","#4e5969","#272e3b","#1d2129"],t.gray.dark=["#17171a","#2e2e30","#484849","#5f5f60","#78787a","#929293","#ababac","#c5c5c5","#dfdfdf","#f6f6f6"],t.gray.primary=t.gray.light[6],t}d.blendInHct=T,d.blendUIColors=P,d.colorList=F,d.extractColorFromFile=N,d.extractColorFromImage=A,d.generate=C,d.generateControlColors=$,d.generateGrayLinear=U,d.generateInterfaceColorSystem=X,d.generateLinear=I,d.generateLinearHSL=W,d.generateMonochromeLinear=K,d.generateSemanticColors=B,d.generateThemeColors=L,d.generateThemePalette=Y,d.generateThemeVariants=Q,d.getPresetColors=Z,d.getRgbStr=z,d.harmonizeColor=J,d.hctToRgb=H,d.rgbToHct=E,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
